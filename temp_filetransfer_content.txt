private fun receiveFile(transferInfo: Map<*, *>?) {
        if (transferInfo == null) {
            Log.e(TAG, "无效的传输信息")
            return
        }
        
        serviceScope.launch {
            try {
                val fileName = transferInfo["fileName"] as? String ?: "received_file"
                val fileSize = (transferInfo["fileSize"] as? Number)?.toLong() ?: 0L
                val senderDeviceId = transferInfo["senderDeviceId"] as? String ?: "unknown"
                val transferId = transferInfo["transferId"] as? String ?: UUID.randomUUID().toString()
                
                // 创建接收目录
                val downloadDir = File(getExternalFilesDir(Environment.DIRECTORY_DOWNLOADS), "WindowsAndroidConnect")
                if (!downloadDir.exists()) {
                    downloadDir.mkdirs()
                }
                
                val file = File(downloadDir, fileName)
                val fileOutputStream = FileOutputStream(file)
                
                // 这里需要监听网络消息来接收文件块
                // 简化处理，实际实现中需要更复杂的逻辑
                
                fileOutputStream.close()
                Log.d(TAG, "文件接收完成: ${file.name}")
                
            } catch (e: Exception) {
                Log.e(TAG, "文件接收失败", e)
                // 发送传输错误
                val dummyTransferInfo = FileTransferInfo(transferId, "", fileName, fileSize, senderDeviceId)
                sendTransferError(dummyTransferInfo, e.message ?: "接收失败")
            }
        }
    }